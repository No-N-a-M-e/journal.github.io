<!DOCTYPE html>
<html lang="ru">
<script src="https://unpkg.com/getparameterbyname/dist/bundle.min.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.1.2/firebase-app-compat.js" type="text/javascript" type="module"></script>
<script src="https://www.gstatic.com/firebasejs/9.1.2/firebase-firestore-compat.js" type="text/javascript" type="module"></script>
<script src="https://www.gstatic.com/firebasejs/9.1.2/firebase-auth-compat.js" type="text/javascript" type="module"></script>
<script>
document.addEventListener('DOMContentLoaded', () => {
  console.log(document.referrer);
  console.log($_SERVER['HTTP_REFERER']);
  const mode = getParameterByName('mode');
  const actionCode = getParameterByName('oobCode');
  const continueUrl = getParameterByName('continueUrl');
  const lang = getParameterByName('lang') || 'ru';
  console.log(mode,actionCode,continueUrl,lang);
  const app = firebase.initializeApp({
    apiKey: "AIzaSyCuU3_U0yblB7IHdY8CTJb3nY5SSdIlmK8",
    authDomain: "basr-d0079.firebaseapp.com",
    databaseURL: "https://basr-d0079-default-rtdb.firebaseio.com",
    projectId: "basr-d0079",
    storageBucket: "basr-d0079.appspot.com",
    messagingSenderId: "250883445973",
    appId: "1:250883445973:web:c200dd55f9dfd739e0fe5c",
    measurementId: "G-3M0ZDER1R6"
  });
  const auth = app.auth();

  switch (mode) {
    case 'resetPassword':
      handleResetPassword(auth, actionCode, continueUrl, lang);
      break;
    case 'recoverEmail':
      handleRecoverEmail(auth, actionCode, lang);
      break;
    case 'verifyEmail':
      handleVerifyEmail(auth, actionCode, continueUrl, lang);
      console.log('Verified');
      break;
    default:
  }
}, false);
</script>
</html>